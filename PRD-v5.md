# Todo App v5 — User Experience & Polish

Building on the existing Express + React + PostgreSQL todo app (which has todos, subtasks, export, polished UI, due dates, priorities, and search/filter).

## Tasks

- [x] Add inline editing: clicking on a todo title should turn it into an editable text input pre-filled with the current title. Pressing Enter or clicking outside (blur) should save the change via the PUT API. Pressing Escape should cancel the edit. The edit mode should have a subtle visual indicator (e.g., a text cursor, slight background change). **Verify:** Use the browser to create a todo, click its title, change the text, press Enter, and confirm the title updates. Also test Escape to cancel without saving.

- [ ] Add drag-and-drop reorder: add a `position INTEGER` column to the `todos` table. Add a PUT `/api/todos/reorder` endpoint that accepts an array of `{id, position}` objects and updates all positions in a single transaction. Install `@hello-pangea/dnd` (or similar React DnD library) and make the todo list items draggable with a grip/handle icon on the left side. After a drag completes, call the reorder API and persist the new order. The todo list should always display in position order (with a fallback to created_at DESC for todos without a position). **Verify:** Use the browser to create 3+ todos, drag one to a different position, reload the page, and confirm the new order persists.

- [ ] Add dark/light mode toggle: add a theme toggle button (sun/moon icon) in the header next to the export buttons. Implement a dark theme using CSS custom properties — dark background, light text, adjusted card colors, and proper contrast. Store the user's preference in localStorage and apply it on page load. The toggle should smoothly transition between themes (use CSS transitions on background-color and color). **Verify:** Use the browser to click the theme toggle and confirm the app switches to dark mode with proper styling. Reload the page and confirm the preference persists.

- [ ] Add undo delete with toast notification: when a todo is deleted, instead of immediately removing it, show a toast/snackbar notification at the bottom of the screen saying "Todo deleted" with an "Undo" button. The toast should auto-dismiss after 5 seconds. If the user clicks Undo, restore the todo. Only actually call the DELETE API after the 5-second grace period expires without an undo. The toast should have a smooth slide-in/slide-out animation. If multiple todos are deleted in quick succession, stack the toasts. **Verify:** Use the browser to delete a todo and confirm the toast appears. Click Undo and confirm the todo reappears. Delete another todo, wait 5 seconds, and confirm it is permanently removed.

- [ ] Add keyboard shortcuts: implement the following shortcuts — `n` focuses the add-todo input, `/` focuses the search input, `Escape` blurs any focused input. Add a small keyboard icon button in the header that shows a shortcuts help modal/popup listing all available shortcuts when clicked. The shortcuts should only activate when no input is currently focused. **Verify:** Use the browser to press `n` and confirm the add-todo input is focused. Press Escape, then press `/` and confirm the search input is focused. Click the keyboard icon and confirm the help modal appears.

- [ ] Add a sort control in the UI: add a dropdown or segmented button near the filter chips that lets the user sort by "Newest" (default, created_at DESC), "Due Date" (due_date ASC nulls last), or "Priority" (high→medium→low). The active sort should be visually indicated. The sort selection should call the API with the appropriate `?sort=` param. **Verify:** Use the browser to create todos with different due dates and priorities. Select "Priority" sort and confirm high-priority todos appear first. Select "Due Date" sort and confirm todos are ordered by due date.
